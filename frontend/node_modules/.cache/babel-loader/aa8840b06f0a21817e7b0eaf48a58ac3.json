{"ast":null,"code":"import _toConsumableArray from \"/home/ivan/react-mesto-api-full/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/home/ivan/react-mesto-api-full/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/ivan/react-mesto-api-full/frontend/src/components/App.js\";\nimport React, { useEffect, useState } from 'react';\nimport Header from './Header';\nimport Main from './Main';\nimport Footer from './Footer';\nimport ImagePopup from './ImagePopup';\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPopup from \"./AddPopup\";\nimport DeletePopup from \"./DeletePopup\";\nimport { Route, Routes, useNavigate, useLocation, Navigate } from 'react-router-dom';\nimport { api } from '../utils/Api';\n/* import api from '../utils/Api'; */\n\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext.js\";\nimport Register from '../components/Register';\nimport Login from '../components/Login';\nimport RequireAuth from './ProtectedRoute';\nimport * as auth from '../utils/auth';\nimport InfoTooltip from '../components/InfoTooltip';\n\nfunction App() {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      loggedIn = _useState2[0],\n      setLoggedIn = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      userEmail = _useState4[0],\n      setUserEmail = _useState4[1];\n\n  var navigate = useNavigate();\n  var location = useLocation();\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isEditProfilePopupOpen = _React$useState2[0],\n      setIsEditProfilePopupOpen = _React$useState2[1];\n\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      isAddCardPopupOpen = _React$useState4[0],\n      setisAddCardPopupOpen = _React$useState4[1];\n\n  function handleAddCardClick() {\n    setisAddCardPopupOpen(true);\n  }\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      isAvatarProfilePopupOpen = _React$useState6[0],\n      setisAvatarProfilePopupOpen = _React$useState6[1];\n\n  function handleAvatarProfileClick() {\n    setisAvatarProfilePopupOpen(true);\n  }\n\n  var _React$useState7 = React.useState(null),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      selectedCard = _React$useState8[0],\n      setSelectedCard = _React$useState8[1];\n\n  function handleCardClick(card) {\n    setSelectedCard(card);\n    setIsImagePopupOpenen(true);\n  }\n\n  var _React$useState9 = React.useState(false),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      isImagePopupOpenen = _React$useState10[0],\n      setIsImagePopupOpenen = _React$useState10[1]; ////////////////////////\n\n\n  var _React$useState11 = React.useState(false),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      isSucceed = _React$useState12[0],\n      setIsSucceed = _React$useState12[1];\n\n  var _React$useState13 = React.useState(false),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      isInfoTooltipOpen = _React$useState14[0],\n      setIsInfoTooltipOpen = _React$useState14[1];\n\n  function handleInfoTooltipPopupOpen() {\n    setIsInfoTooltipOpen(!isInfoTooltipOpen);\n  }\n\n  function closeAllPopups() {\n    setIsEditProfilePopupOpen(false);\n    setisAddCardPopupOpen(false);\n    setisAvatarProfilePopupOpen(false);\n    setSelectedCard(null);\n    setIsDeletePopupOpenen(false);\n    setIsImagePopupOpenen(false);\n    setIsInfoTooltipOpen(false);\n  } ////////////////////////////////////////////\n\n\n  useEffect(function () {\n    if (loggedIn) {\n      Promise.all([api.getUserInfo(), api.getInitialCards()]).then(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            user = _ref2[0],\n            items = _ref2[1];\n\n        console.log(user); //console.log(user.data);\n\n        setCurrentUser(user.data);\n        setCards(items);\n        navigate('/');\n      }).catch(function (err) {\n        console.log(err);\n      });\n    }\n  }, [loggedIn]);\n  useEffect(function () {\n    handleTokenCheck(location.pathname);\n  }, [loggedIn]);\n\n  var _React$useState15 = React.useState({}),\n      _React$useState16 = _slicedToArray(_React$useState15, 2),\n      currentUser = _React$useState16[0],\n      setCurrentUser = _React$useState16[1];\n  /* React.useEffect(() => {\n    if (loggedIn) {\n      api\n        .getUserInfo()\n        .then((data) => {\n          setCurrentUser(data);\n        })\n        .catch((err) => console.log(err));\n    }\n  }, [loggedIn]); */\n\n\n  var _React$useState17 = React.useState([]),\n      _React$useState18 = _slicedToArray(_React$useState17, 2),\n      cards = _React$useState18[0],\n      setCards = _React$useState18[1];\n  /* React.useEffect(() => {\n    if (loggedIn) {\n      api\n        .getInitialCards()\n        .then((data) => {\n          setCards(data);\n        })\n        .catch((err) => console.log(err));\n    } \n  }, [loggedIn]); */\n  ///////////////////////////////////////////\n\n\n  function handleCardLike(card) {\n    var isLiked = card.likes.some(function (i) {\n      return i === currentUser._id;\n    });\n\n    if (isLiked) {\n      api.deleteLike(card._id).then(function (newCard) {\n        setCards(function (state) {\n          return state.map(function (c) {\n            return c._id === card._id ? newCard : c;\n          });\n        });\n      }).catch(function (err) {\n        console.log(err);\n        return [];\n      });\n    } else {\n      api.addLike(card._id).then(function (newCard) {\n        setCards(function (state) {\n          return state.map(function (c) {\n            return c._id === card._id ? newCard : c;\n          });\n        });\n      }).catch(function (err) {\n        console.log(err);\n        return [];\n      });\n    }\n  } ////////////////\n\n\n  function handleEditUser(data) {\n    api.editProfile(data).then(function (data) {\n      setCurrentUser(data.data);\n      console.log(data);\n      closeAllPopups();\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  }\n\n  function handleUpdateAvatar(data) {\n    api.addAvatar(data).then(function (data) {\n      console.log(data);\n      setCurrentUser(data.data);\n      closeAllPopups();\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  }\n\n  function handleAddPlace(data) {\n    api.addPlace(data).then(function (newCard) {\n      console.log(data);\n      setCards([newCard].concat(_toConsumableArray(cards)));\n      closeAllPopups();\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  }\n\n  var _React$useState19 = React.useState(false),\n      _React$useState20 = _slicedToArray(_React$useState19, 2),\n      isDeletePopupOpenen = _React$useState20[0],\n      setIsDeletePopupOpenen = _React$useState20[1];\n\n  function handleCardDeleteClick(card) {\n    setIsDeletePopupOpenen(true);\n    setSelectedCard(card);\n  }\n\n  function handleDeletePlace(card) {\n    api.deletePost(card._id).then(function () {\n      setCards(function (state) {\n        return state.filter(function (c) {\n          return c._id !== card._id;\n        });\n      });\n      closeAllPopups();\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  } /////////////1/////////////\n\n  /* useEffect(() => {\n    handleTokenCheck(location.pathname);\n  }, [loggedIn]); */\n  /////////\n\n  /*  useEffect(() => {\n     // проверка токена \n     handleTokenCheck(location.pathname);\n     // запрос в API за пользовательскими данными\n     if (loggedIn){\n       Promise.all([ \n       api.getUserInfo(),\n       api.getInitialCards()\n       ])\n       .then((res) => {\n         setCurrentUser(res[0].data);\n         setCards(res[1])\n       })\n       .catch((err) => {\n         console.log(err); // \"Что-то пошло не так: ...\"\n         return [];\n       })}\n   }, [loggedIn]); */\n  ///////////\n\n\n  var handleLogin = function handleLogin(email, password) {\n    auth.authorize(email, password).then(function (res) {\n      console.log(res.token); //console.log(localStorage.getItem('jwt'));\n\n      if (res.token) {\n        setLoggedIn(true);\n        setUserEmail(email);\n        localStorage.setItem('jwt', res.token);\n        navigate(\"/\"); // и переадресуем пользователя! \n        //console.log(localStorage.getItem('jwt'));\n      }\n    }).catch(function (err) {\n      console.log(err);\n      setIsSucceed(false);\n      handleInfoTooltipPopupOpen();\n    });\n  };\n\n  var handleTokenCheck = function handleTokenCheck(path) {\n    // if (localStorage.getItem(\"jwt\")) {\n    var jwt = localStorage.getItem(\"jwt\"); // проверяем токен пользователя\n\n    auth.checkToken(jwt).then(function (res) {\n      if (res) {\n        console.log('hz' + jwt);\n        setLoggedIn(true);\n        setUserEmail(res.data.email);\n        navigate(path);\n      }\n    }).catch(function (err) {\n      return console.log(err);\n    }); //}\n  };\n\n  var handleLogout = function handleLogout(evt) {\n    evt.preventDefault();\n    localStorage.removeItem('jwt');\n    setLoggedIn(false);\n    setUserEmail('');\n    navigate('/signin');\n  };\n\n  var handleRegister = function handleRegister(password, email) {\n    auth.register(email, password).then(function (res) {\n      if (res) {\n        setIsSucceed(true);\n        handleInfoTooltipPopupOpen();\n        navigate(\"/signin\");\n      }\n    }).catch(function (err) {\n      console.log(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u0438 \".concat(err));\n      setIsSucceed(false);\n      handleInfoTooltipPopupOpen();\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(CurrentUserContext.Provider, {\n    value: currentUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Routes, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Route, {\n    path: \"/\",\n    element: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(RequireAuth, {\n      loggedIn: loggedIn,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      nav: '/signin',\n      navStatus: 'Выйти',\n      emailUser: userEmail,\n      onLogout: handleLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Main, {\n      onEditProfile: handleEditProfileClick,\n      onAddPlace: handleAddCardClick,\n      onEditAvatar: handleAvatarProfileClick,\n      onCardClick: handleCardClick,\n      onCardLike: handleCardLike,\n      onCardDeleteClick: handleCardDeleteClick,\n      cards: cards,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 25\n      }\n    })))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/sign-up\",\n    element: /*#__PURE__*/React.createElement(Register, {\n      onRegister: handleRegister,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 47\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/signin\",\n    element: /*#__PURE__*/React.createElement(Login, {\n      onLogin: handleLogin,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 46\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"*\",\n    element: loggedIn ? /*#__PURE__*/React.createElement(Navigate, {\n      to: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 39\n      }\n    }) : /*#__PURE__*/React.createElement(Navigate, {\n      to: \"/signin\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 61\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(InfoTooltip, {\n    isOpen: isInfoTooltipOpen,\n    onClose: closeAllPopups,\n    isSucceed: isSucceed,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(EditProfilePopup, {\n    isOpen: isEditProfilePopupOpen,\n    onClose: closeAllPopups,\n    onEditUser: handleEditUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(AddPopup, {\n    isOpen: isAddCardPopupOpen,\n    onClose: closeAllPopups,\n    onAddPost: handleAddPlace,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(EditAvatarPopup, {\n    isOpen: isAvatarProfilePopupOpen,\n    onClose: closeAllPopups,\n    onUpdateAvatar: handleUpdateAvatar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(ImagePopup, {\n    isOpen: isImagePopupOpenen,\n    card: selectedCard,\n    onClose: closeAllPopups,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(DeletePopup, {\n    isOpen: isDeletePopupOpenen,\n    onClose: closeAllPopups,\n    card: selectedCard,\n    onDeletePlace: handleDeletePlace,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 11\n    }\n  })));\n}\n\nexport default App;","map":{"version":3,"sources":["/home/ivan/react-mesto-api-full/frontend/src/components/App.js"],"names":["React","useEffect","useState","Header","Main","Footer","ImagePopup","EditProfilePopup","EditAvatarPopup","AddPopup","DeletePopup","Route","Routes","useNavigate","useLocation","Navigate","api","CurrentUserContext","Register","Login","RequireAuth","auth","InfoTooltip","App","loggedIn","setLoggedIn","userEmail","setUserEmail","navigate","location","isEditProfilePopupOpen","setIsEditProfilePopupOpen","handleEditProfileClick","isAddCardPopupOpen","setisAddCardPopupOpen","handleAddCardClick","isAvatarProfilePopupOpen","setisAvatarProfilePopupOpen","handleAvatarProfileClick","selectedCard","setSelectedCard","handleCardClick","card","setIsImagePopupOpenen","isImagePopupOpenen","isSucceed","setIsSucceed","isInfoTooltipOpen","setIsInfoTooltipOpen","handleInfoTooltipPopupOpen","closeAllPopups","setIsDeletePopupOpenen","Promise","all","getUserInfo","getInitialCards","then","user","items","console","log","setCurrentUser","data","setCards","catch","err","handleTokenCheck","pathname","currentUser","cards","handleCardLike","isLiked","likes","some","i","_id","deleteLike","newCard","state","map","c","addLike","handleEditUser","editProfile","handleUpdateAvatar","addAvatar","handleAddPlace","addPlace","isDeletePopupOpenen","handleCardDeleteClick","handleDeletePlace","deletePost","filter","handleLogin","email","password","authorize","res","token","localStorage","setItem","path","jwt","getItem","checkToken","handleLogout","evt","preventDefault","removeItem","handleRegister","register"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Header from './Header';\nimport Main from './Main';\nimport Footer from './Footer';\nimport ImagePopup from './ImagePopup';\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPopup from \"./AddPopup\";\nimport DeletePopup from \"./DeletePopup\";\nimport { Route, Routes, useNavigate, useLocation,Navigate } from 'react-router-dom';\nimport {api}  from '../utils/Api';\n/* import api from '../utils/Api'; */\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext.js\";\nimport Register from '../components/Register';\nimport Login from '../components/Login';\nimport RequireAuth from './ProtectedRoute';\nimport * as auth from '../utils/auth';\nimport InfoTooltip from '../components/InfoTooltip';\n\nfunction App() {\n  \n  const [loggedIn, setLoggedIn] = useState(false);\n  const [userEmail, setUserEmail] = useState('');\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = React.useState(false);\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n  const [isAddCardPopupOpen, setisAddCardPopupOpen] = React.useState(false);\n  function handleAddCardClick() {\n    setisAddCardPopupOpen(true);\n  }\n  const [isAvatarProfilePopupOpen, setisAvatarProfilePopupOpen] = React.useState(false);\n  function handleAvatarProfileClick() {\n    setisAvatarProfilePopupOpen(true);\n  }\n  const [selectedCard, setSelectedCard] = React.useState(null);\n  function handleCardClick(card) {\n    setSelectedCard(card);\n    setIsImagePopupOpenen(true);\n  }\n  const [isImagePopupOpenen, setIsImagePopupOpenen] = React.useState(false);\n  ////////////////////////\n  const [isSucceed, setIsSucceed] = React.useState(false);\n  const [isInfoTooltipOpen, setIsInfoTooltipOpen] = React.useState(false);\n  function handleInfoTooltipPopupOpen() {\n    setIsInfoTooltipOpen(!isInfoTooltipOpen);\n  }\n  \n  function closeAllPopups() {\n    setIsEditProfilePopupOpen(false);\n    setisAddCardPopupOpen(false);\n    setisAvatarProfilePopupOpen(false);\n    setSelectedCard(null);\n    setIsDeletePopupOpenen(false);\n    setIsImagePopupOpenen(false);\n    setIsInfoTooltipOpen(false);\n  }\n  ////////////////////////////////////////////\n  useEffect(() => {\n    if (loggedIn) {\n      Promise.all([api.getUserInfo(), api.getInitialCards()])\n        .then(([user, items]) => {\n          console.log(user);\n          //console.log(user.data);\n          setCurrentUser(user.data);\n          setCards(items);\n          navigate('/');\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    }\n  }, [loggedIn]); \n\n  useEffect(() => {\n    handleTokenCheck(location.pathname);\n  }, [loggedIn]);\n\n  const [currentUser, setCurrentUser] = React.useState({});\n  /* React.useEffect(() => {\n    if (loggedIn) {\n      api\n        .getUserInfo()\n        .then((data) => {\n          setCurrentUser(data);\n        })\n        .catch((err) => console.log(err));\n    }\n  }, [loggedIn]); */\n  \n  const [cards, setCards] = React.useState([]);\n  /* React.useEffect(() => {\n    if (loggedIn) {\n      api\n        .getInitialCards()\n        .then((data) => {\n          setCards(data);\n        })\n        .catch((err) => console.log(err));\n    } \n  }, [loggedIn]); */\n  ///////////////////////////////////////////\n  function handleCardLike(card){\n    const isLiked = card.likes.some((i) => i === currentUser._id);\n    \n    if (isLiked) {\n      api\n        .deleteLike(card._id)\n        .then((newCard) => {\n          setCards((state) => state.map((c) => (c._id === card._id ? newCard : c)));\n        })\n        .catch((err) => {\n          console.log(err);\n          return [];\n        });\n    } else {\n      api\n        .addLike(card._id)\n        .then((newCard) => {\n          setCards((state) => state.map((c) => (c._id === card._id ? newCard : c)));\n        })\n        .catch((err) => {\n          console.log(err);\n          return [];\n        });\n    }\n  } \n////////////////\n  function handleEditUser(data) {\n    api\n      .editProfile(data)\n      .then((data) => {\n        setCurrentUser(data.data);\n        console.log(data);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleUpdateAvatar(data) {\n    api\n      .addAvatar(data)\n      .then((data) => {\n        console.log(data);\n        setCurrentUser(data.data);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n  function handleAddPlace(data) {\n    api\n      .addPlace(data)\n      .then((newCard) => {\n        console.log(data);\n        setCards([newCard, ...cards]);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n  const [isDeletePopupOpenen, setIsDeletePopupOpenen] =React.useState(false);\n  function handleCardDeleteClick(card) {\n    setIsDeletePopupOpenen(true);\n    setSelectedCard(card);\n  }\n  function handleDeletePlace(card) {\n    api\n      .deletePost(card._id)\n      .then(() => {\n        setCards((state) => state.filter((c) => c._id !== card._id));\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n/////////////1/////////////\n  /* useEffect(() => {\n    handleTokenCheck(location.pathname);\n  }, [loggedIn]); */\n  /////////\n /*  useEffect(() => {\n    // проверка токена \n    handleTokenCheck(location.pathname);\n    // запрос в API за пользовательскими данными\n    if (loggedIn){\n      Promise.all([ \n      api.getUserInfo(),\n      api.getInitialCards()\n      ])\n      .then((res) => {\n        setCurrentUser(res[0].data);\n        setCards(res[1])\n      })\n      .catch((err) => {\n        console.log(err); // \"Что-то пошло не так: ...\"\n        return [];\n      })}\n  }, [loggedIn]); */\n  ///////////\n\n  \n\n  const handleLogin = (email, password) => {\n    auth\n    .authorize(email, password)\n      .then((res) => {\n        console.log(res.token);\n        //console.log(localStorage.getItem('jwt'));\n        if (res.token) {\n          setLoggedIn(true);\n          setUserEmail(email);\n          localStorage.setItem('jwt', res.token);\n          navigate(\"/\"); // и переадресуем пользователя! \n          //console.log(localStorage.getItem('jwt'));\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n        setIsSucceed(false);\n        handleInfoTooltipPopupOpen();\n      });\n  };\n  const handleTokenCheck = (path) => {\n   // if (localStorage.getItem(\"jwt\")) {\n      const jwt = localStorage.getItem(\"jwt\");\n    // проверяем токен пользователя\n      auth.checkToken(jwt).then((res) => {\n        if (res) {\n          console.log('hz'+jwt);\n          setLoggedIn(true);\n          setUserEmail(res.data.email);\n          navigate(path);\n        }\n      })\n      .catch((err) => console.log(err));\n    //}\n  };\n\n  const handleLogout= (evt) => {\n    evt.preventDefault();\n    localStorage.removeItem('jwt');\n    setLoggedIn(false);\n    setUserEmail('');\n    navigate('/signin')\n  }\n\n  const handleRegister = (password, email) => {\n    auth.register(email, password)\n      .then((res) => {\n        if (res) {\n          setIsSucceed(true);\n          handleInfoTooltipPopupOpen();\n          navigate(\"/signin\");\n        }\n      })\n      .catch((err) => {\n        console.log(`Ошибка регистрации ${err}`);\n        setIsSucceed(false);\n        handleInfoTooltipPopupOpen();\n      });\n  }; \n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"page\">\n          <Routes>\n            <>\n              <Route\n                path=\"/\"\n                element={\n                  <>\n                    <RequireAuth loggedIn={loggedIn}>\n                      <div>\n                        <Header \n                        nav={'/signin'}\n                        navStatus={'Выйти'} \n                        emailUser={userEmail} \n                        onLogout={handleLogout} \n                        />\n                        <Main \n                          onEditProfile={handleEditProfileClick}\n                          onAddPlace={handleAddCardClick}\n                          onEditAvatar={handleAvatarProfileClick}\n                          onCardClick={handleCardClick}\n                          onCardLike={handleCardLike}\n                          onCardDeleteClick={handleCardDeleteClick}\n                          cards={cards}\n                        />  \n                        <Footer />\n                      </div>\n                    </RequireAuth>\n                  </>\n                }\n              />  \n              <Route path=\"/sign-up\" element={<Register onRegister={handleRegister}/> } />\n              <Route path=\"/signin\" element={<Login onLogin={handleLogin}/>} />\n              <Route\n                  path='*'\n                  element={loggedIn ? <Navigate to='/' /> : <Navigate to='/signin' />}\n              />\n            </> \n          </Routes>\n          <InfoTooltip\n            isOpen={isInfoTooltipOpen}\n            onClose={closeAllPopups}\n            isSucceed={isSucceed}\n          />\n          <EditProfilePopup\n            isOpen={isEditProfilePopupOpen}\n            onClose={closeAllPopups}\n            onEditUser={handleEditUser}\n          />\n          <AddPopup\n            isOpen={isAddCardPopupOpen}\n            onClose={closeAllPopups}\n            onAddPost={handleAddPlace}\n          />\n          <EditAvatarPopup\n            isOpen={isAvatarProfilePopupOpen}\n            onClose={closeAllPopups}\n            onUpdateAvatar={handleUpdateAvatar}\n          />\n          <ImagePopup \n            isOpen={isImagePopupOpenen}\n            card={selectedCard}\n            onClose={closeAllPopups}\n          />\n          <DeletePopup\n            isOpen={isDeletePopupOpenen}\n            onClose={closeAllPopups}\n            card={selectedCard}\n            onDeletePlace={handleDeletePlace}\n          />\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}